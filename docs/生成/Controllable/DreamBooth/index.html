<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  Approach[1]
  #

Our method takes as input a few images (typically 3-5 images suffice, based on our experiments) of a subject (e.g., a specific dog) and the corresponding class name (e.g. &ldquo;dog&rdquo;), and returns a fine-tuned/&ldquo;personalized&rsquo;&rsquo; text-to-image model that encodes a unique identifier that refers to the subject. Then, at inference, we can implant the unique identifier in different sentences to synthesize the subjects in difference contexts.
我们的方法将主题（例如，特定的狗）和相应的类名称（例如“狗”）的一些图像（根据我们的实验，通常 3-5 个图像就足够了）作为输入，并返回一个微调/ “个性化”文本到图像模型，编码指向主题的唯一标识符。然后，在推理时，我们可以将唯一标识符植入不同的句子中，以合成不同上下文中的主题。">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://www6v.github.io/www6vVision/docs/%E7%94%9F%E6%88%90/Controllable/DreamBooth/">
  <meta property="og:site_name" content="Vision">
  <meta property="og:title" content="(原理|实战)DreamBooth">
  <meta property="og:description" content="Approach[1] # Our method takes as input a few images (typically 3-5 images suffice, based on our experiments) of a subject (e.g., a specific dog) and the corresponding class name (e.g. “dog”), and returns a fine-tuned/“personalized’’ text-to-image model that encodes a unique identifier that refers to the subject. Then, at inference, we can implant the unique identifier in different sentences to synthesize the subjects in difference contexts. 我们的方法将主题（例如，特定的狗）和相应的类名称（例如“狗”）的一些图像（根据我们的实验，通常 3-5 个图像就足够了）作为输入，并返回一个微调/ “个性化”文本到图像模型，编码指向主题的唯一标识符。然后，在推理时，我们可以将唯一标识符植入不同的句子中，以合成不同上下文中的主题。">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">
<title>(原理|实战)DreamBooth | Vision</title>
<link rel="icon" href="/www6vVision/favicon.png" >
<link rel="manifest" href="/www6vVision/manifest.json">
<link rel="canonical" href="https://www6v.github.io/www6vVision/docs/%E7%94%9F%E6%88%90/Controllable/DreamBooth/">
<link rel="stylesheet" href="/www6vVision/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css" integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin="anonymous">
  <script defer src="/www6vVision/fuse.min.js"></script>
  <script defer src="/www6vVision/en.search.min.67ceb4de854af2314d620684756849251f57fa2d2c6a69ef2c9c3f0f03dcf954.js" integrity="sha256-Z8603oVK8jFNYgaEdWhJJR9X&#43;i0samnvLJw/DwPc&#43;VQ=" crossorigin="anonymous"></script>
<link rel="alternate" type="application/rss+xml" href="https://www6v.github.io/www6vVision/docs/%E7%94%9F%E6%88%90/Controllable/DreamBooth/index.xml" title="Vision" />
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/www6vVision/"><span>Vision</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-a7a6c173855ef5d21d37c3867e9d463f" class="toggle"  />
    <label for="section-a7a6c173855ef5d21d37c3867e9d463f" class="flex justify-between">
      <a role="button" class="">Survey</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/Survey/MultimodalSeries/" class="">多模态 系列</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/Survey/MultimodalSurvey/" class="">(Survey)多模态</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/Survey/Multimodal/" class="">(综述)多模态</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-c0ab9c3273b3f23a856bb12f640857f1" class="toggle"  />
    <label for="section-c0ab9c3273b3f23a856bb12f640857f1" class="flex justify-between">
      <a role="button" class="">视觉理解</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0c6f5585f5e480d3e24a4bf7efa7a6aa" class="toggle"  />
    <label for="section-0c6f5585f5e480d3e24a4bf7efa7a6aa" class="flex justify-between">
      <a role="button" class="">Vision Encoder</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E8%A7%86%E8%A7%89%E7%90%86%E8%A7%A3/Vision-Encoder/VQVAE/" class="">VQ-VAE</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E8%A7%86%E8%A7%89%E7%90%86%E8%A7%A3/Vision-Encoder/DINO/" class="">DINO</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E8%A7%86%E8%A7%89%E7%90%86%E8%A7%A3/Vision-Encoder/CLIP/" class="">(原理)CLIP</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E8%A7%86%E8%A7%89%E7%90%86%E8%A7%A3/Vision-Encoder/ViT/" class="">(原理|实战)ViT, ViLT</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E8%A7%86%E8%A7%89%E7%90%86%E8%A7%A3/Vision-Encoder/CLIPPractice/" class="">(实战)CLIP</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-59d5a4a57b02830e81317b476374fd6a" class="toggle"  />
    <label for="section-59d5a4a57b02830e81317b476374fd6a" class="flex justify-between">
      <a role="button" class="">Connector</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E8%A7%86%E8%A7%89%E7%90%86%E8%A7%A3/Connector/Connector/" class="">(原理)Connector</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ef6dc6daebcb2103bd104a5d412d6a95" class="toggle"  />
    <label for="section-ef6dc6daebcb2103bd104a5d412d6a95" class="flex justify-between">
      <a role="button" class="">Segmentation</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E8%A7%86%E8%A7%89%E7%90%86%E8%A7%A3/seg/SAM/" class="">(原理|实战) SAM</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-1b8e1c1481a25df1c807b33ddfba8040" class="toggle" checked />
    <label for="section-1b8e1c1481a25df1c807b33ddfba8040" class="flex justify-between">
      <a role="button" class="">生成</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-795b65cbbf8117cd83686969cd72d7f5" class="toggle"  />
    <label for="section-795b65cbbf8117cd83686969cd72d7f5" class="flex justify-between">
      <a role="button" class="">Diffusion</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Diffusion/Diffusion/" class="">(原理)Stable Diffusion</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Diffusion/DiffusionPractice/" class="">(实战)Stable Diffusion</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Diffusion/DiffusionXL/" class="">(原理)SD XL</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Diffusion/Guidance/" class="">(原理)Guidance</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Diffusion/unCLIP/" class="">(原理)unCLIP</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Diffusion/DiT/" class="">(原理|实战)DiT</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-1b2aa7832a4d8939e814125e1948a4b3" class="toggle" checked />
    <label for="section-1b2aa7832a4d8939e814125e1948a4b3" class="flex justify-between">
      <a role="button" class="">Controllable</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Controllable/FineTuning/" class="">(work|实战) fine-tuning</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Controllable/ControllableWork/" class="">(Work|实战)Controllable</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Controllable/ControlNet/" class="">(原理|实战)ControlNet</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Controllable/DreamBooth/" class="active">(原理|实战)DreamBooth</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Controllable/IPAdapter/" class="">(原理|实战)IP-Adapter</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Controllable/ReferenceNet/" class="">(原理|实战)ReferenceNet</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Controllable/T2IAdapter/" class="">(原理|实战)T2I-Adapter</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Controllable/Controllable/" class="">(综述)Controllable</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d9071985d3160fb1fa6eef8f9dc6cb04" class="toggle"  />
    <label for="section-d9071985d3160fb1fa6eef8f9dc6cb04" class="flex justify-between">
      <a role="button" class="">Editing</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Editing/Pix2pix/" class="">pix2pix-zero</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Editing/Instruct/" class="">InstructPix2Pix</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Editing/Prompt/" class="">Prompt-to-Prompt</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Editing/ImageEditWork/" class="">(Work|实战)Image Editing</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Editing/ImageEdit/" class="">(综述)Image Editing</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/Editing/MGIE/" class="">MGIE</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-b16cccda09102f993e096fdddb9640bb" class="toggle"  />
    <label for="section-b16cccda09102f993e096fdddb9640bb" class="flex justify-between">
      <a role="button" class="">人像生图</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%94%9F%E6%88%90/%E4%BA%BA%E5%83%8F%E7%94%9F%E5%9B%BE/IDCreate/" class="">人像生图</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-81e1d60f5ba04ea0faae6264fed71d9e" class="toggle"  />
    <label for="section-81e1d60f5ba04ea0faae6264fed71d9e" class="flex justify-between">
      <a role="button" class="">端到端训练LLM(LMM)</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7f1ccca088b04efd753bc6be2e898eb6" class="toggle"  />
    <label for="section-7f1ccca088b04efd753bc6be2e898eb6" class="flex justify-between">
      <a role="button" class="">Works</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%AB%AF%E5%88%B0%E7%AB%AF%E8%AE%AD%E7%BB%83LLMLMM/Works/Blip/" class="">BLIP-2</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%AB%AF%E5%88%B0%E7%AB%AF%E8%AE%AD%E7%BB%83LLMLMM/Works/Minigpt4/" class="">(原理|实战)MiniGPT4</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%AB%AF%E5%88%B0%E7%AB%AF%E8%AE%AD%E7%BB%83LLMLMM/Works/Llava/" class="">(原理|实战) LLaVa 演化</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%AB%AF%E5%88%B0%E7%AB%AF%E8%AE%AD%E7%BB%83LLMLMM/Works/Flamingo/" class="">Flamingo</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9c1f51056927c3adce2458ac6c1e3ab0" class="toggle"  />
    <label for="section-9c1f51056927c3adce2458ac6c1e3ab0" class="flex justify-between">
      <a role="button" class="">Training</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%AB%AF%E5%88%B0%E7%AB%AF%E8%AE%AD%E7%BB%83LLMLMM/Training/InstructTuning/" class="">(综述)多模态InstructTuning</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/%E7%AB%AF%E5%88%B0%E7%AB%AF%E8%AE%AD%E7%BB%83LLMLMM/Training/Pretrain/" class="">(原理)多模态预训练 概述</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-0b05ccaa02a032cff4fb67a07bec622f" class="toggle"  />
    <label for="section-0b05ccaa02a032cff4fb67a07bec622f" class="flex justify-between">
      <a role="button" class="">Multimodal Agent</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/Multimodal-Agent/MultimodalAgentApp/" class="">Agent - UI-assistants</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/Multimodal-Agent/WebAgent/" class="">(原理)Web Agent</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/Multimodal-Agent/MultimodalAgent/" class="">(原理)Agent 多模态</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-e7495aa0cd5a18585caa15338de39e42" class="toggle"  />
    <label for="section-e7495aa0cd5a18585caa15338de39e42" class="flex justify-between">
      <a role="button" class="">Data</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/Data/MulitmodalDataset/" class="">(survey)多模态  数据集</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-5be05fe4845e45443a3dc5a20cdcae9f" class="toggle"  />
    <label for="section-5be05fe4845e45443a3dc5a20cdcae9f" class="flex justify-between">
      <a role="button" class="">Vision</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/www6vVision/docs/Vision/VisionTask/" class="">CV 任务</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/www6vVision/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>(原理|实战)DreamBooth</h3>

  <label for="toc-control">
    
    <img src="/www6vVision/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#approach1">Approach[1]</a></li>
    <li><a href="#dreambooth实战">Dreambooth实战</a>
      <ul>
        <li>
          <ul>
            <li><a href="#dreambooth-in-diffusers-10">Dreambooth in Diffusers [10]</a></li>
            <li><a href="#dreambooth-in-diffusers-examples11">dreambooth in Diffusers examples[11]</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#参考">参考</a>
      <ul>
        <li>
          <ul>
            <li><a href="#dreambooth-原理">Dreambooth 原理</a></li>
            <li><a href="#dreambooth-实战">Dreambooth 实战</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="approach1">
  Approach[1]
  <a class="anchor" href="#approach1">#</a>
</h1>
<p>Our method takes as input a few images (typically 3-5 images suffice, based on our experiments) of a subject (e.g., a specific dog) and the corresponding class name (e.g. &ldquo;dog&rdquo;), and returns a fine-tuned/&ldquo;personalized&rsquo;&rsquo; text-to-image model that encodes a <strong>unique identifier that refers to the subject</strong>. Then, at inference, we can implant the unique identifier in different sentences to synthesize the subjects in difference contexts.
我们的方法将主题（例如，特定的狗）和相应的类名称（例如“狗”）的一些图像（根据我们的实验，通常 3-5 个图像就足够了）作为输入，并返回一个微调/ “个性化”文本到图像模型，编码<strong>指向主题的唯一标识符</strong>。然后，在推理时，我们可以将唯一标识符植入不同的句子中，以合成不同上下文中的主题。</p>
<p><img src="https://dreambooth.github.io/DreamBooth_files/system.png" alt="" /></p>
<p>Given ~3-5 images of a subject we fine tune a text-to-image diffusion in** two steps**:<strong>(a)</strong> fine tuning the low-resolution text-to-image model with the input images paired with a <strong>text prompt containing a unique identifier and the name of the class the subject belongs to (e.g., &ldquo;A photo of a [T] dog”)</strong>, in parallel, we apply a <strong>class-specific prior preservation loss</strong>, which leverages the semantic prior that the model has on the class and encourages it to generate diverse instances belong to the subject&rsquo;s class by injecting the class name in the text prompt (e.g., &ldquo;A photo of a dog”). (b) fine-tuning the super resolution components with pairs of low-resolution and high-resolution images taken from our input images set, which enables us to maintain high-fidelity to small details of the subject.
给定约 3-5 个主题的图像，我们<strong>分两步</strong>微调文本到图像的扩散：(a) 使用与包含唯一的文本提示配对的输入图像微调低分辨率文本到图像模型标识符和主题所属类的名称（例如，“[T]狗的照片”），同时，我们应用特定于类的<strong>先验保存损失</strong>，<strong>它利用模型在类并鼓励它通过在文本提示中注入类名（例如“狗的照片”）来生成属于主题类的不同实例</strong>。 (b) 使用从输入图像集中获取的低分辨率和高分辨率图像对来微调超分辨率组件，这使我们能够保持对象小细节的高保真度。</p>
<h1 id="dreambooth实战">
  Dreambooth实战
  <a class="anchor" href="#dreambooth%e5%ae%9e%e6%88%98">#</a>
</h1>
<h3 id="dreambooth-in-diffusers-10">
  Dreambooth in Diffusers [10]
  <a class="anchor" href="#dreambooth-in-diffusers-10">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">### download pic</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> huggingface_hub <span style="color:#f92672">import</span> snapshot_download
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>local_dir <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./dog&#34;</span>
</span></span><span style="display:flex;"><span>snapshot_download(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;diffusers/dog-example&#34;</span>,
</span></span><span style="display:flex;"><span>    local_dir<span style="color:#f92672">=</span>local_dir, repo_type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dataset&#34;</span>,
</span></span><span style="display:flex;"><span>    ignore_patterns<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;.gitattributes&#34;</span>,
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">### training</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">###  在modelscope上运行有问题，连不上huggingface</span>
</span></span><span style="display:flex;"><span>export MODEL_NAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;CompVis/stable-diffusion-v1-4&#34;</span>
</span></span><span style="display:flex;"><span>export INSTANCE_DIR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dog&#34;</span>
</span></span><span style="display:flex;"><span>export OUTPUT_DIR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;path-to-save-model&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>accelerate launch train_dreambooth<span style="color:#f92672">.</span>py \\
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">--</span>pretrained_model_name_or_path<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">$</span>MODEL_NAME  \\
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">--</span>instance_data_dir<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">$</span>INSTANCE_DIR \\
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">--</span>output_dir<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">$</span>OUTPUT_DIR \\
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">--</span>instance_prompt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;a photo of sks dog&#34;</span> \\
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">--</span>resolution<span style="color:#f92672">=</span><span style="color:#ae81ff">512</span> \\
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">--</span>train_batch_size<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> \\
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">--</span>gradient_accumulation_steps<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> \\
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">--</span>learning_rate<span style="color:#f92672">=</span><span style="color:#ae81ff">5e-6</span> \\
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">--</span>lr_scheduler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;constant&#34;</span> \\
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">--</span>lr_warmup_steps<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> \\
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">--</span>max_train_steps<span style="color:#f92672">=</span><span style="color:#ae81ff">400</span> \\
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">--</span>push_to_hub
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># examples/dreambooth/train_dreambooth.py</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">### 把prior loss加到instance loss上</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> args<span style="color:#f92672">.</span>with_prior_preservation:
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e"># Add the prior loss to the instance loss.</span>
</span></span><span style="display:flex;"><span>                    loss <span style="color:#f92672">=</span> loss <span style="color:#f92672">+</span> args<span style="color:#f92672">.</span>prior_loss_weight <span style="color:#f92672">*</span> prior_loss
</span></span></code></pre></div><h3 id="dreambooth-in-diffusers-examples11">
  dreambooth in Diffusers examples[11]
  <a class="anchor" href="#dreambooth-in-diffusers-examples11">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> args<span style="color:#f92672">.</span>with_prior_preservation:
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e"># Chunk the noise and noise_pred into two parts and compute the loss on each part separately.</span>
</span></span><span style="display:flex;"><span>                    noise_pred, noise_pred_prior <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>chunk(noise_pred, <span style="color:#ae81ff">2</span>, dim<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>                    target, target_prior <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>chunk(target, <span style="color:#ae81ff">2</span>, dim<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e"># Compute instance loss</span>
</span></span><span style="display:flex;"><span>                    loss <span style="color:#f92672">=</span> F<span style="color:#f92672">.</span>mse_loss(noise_pred<span style="color:#f92672">.</span>float(), target<span style="color:#f92672">.</span>float(), reduction<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;none&#34;</span>)<span style="color:#f92672">.</span>mean([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])<span style="color:#f92672">.</span>mean()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e"># Compute prior loss</span>
</span></span><span style="display:flex;"><span>                    prior_loss <span style="color:#f92672">=</span> F<span style="color:#f92672">.</span>mse_loss(noise_pred_prior<span style="color:#f92672">.</span>float(), target_prior<span style="color:#f92672">.</span>float(), reduction<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;mean&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e"># Add the prior loss to the instance loss.</span>
</span></span><span style="display:flex;"><span>                    loss <span style="color:#f92672">=</span> loss <span style="color:#f92672">+</span> args<span style="color:#f92672">.</span>prior_loss_weight <span style="color:#f92672">*</span> prior_loss
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                    loss <span style="color:#f92672">=</span> F<span style="color:#f92672">.</span>mse_loss(noise_pred<span style="color:#f92672">.</span>float(), target<span style="color:#f92672">.</span>float(), reduction<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;mean&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                accelerator<span style="color:#f92672">.</span>backward(loss)
</span></span></code></pre></div><h1 id="参考">
  参考
  <a class="anchor" href="#%e5%8f%82%e8%80%83">#</a>
</h1>
<h3 id="dreambooth-原理">
  Dreambooth 原理
  <a class="anchor" href="#dreambooth-%e5%8e%9f%e7%90%86">#</a>
</h3>
<ol>
<li><a href="https://dreambooth.github.io/">DreamBooth Repo</a></li>
</ol>
<p>1xx. <a href="https://blog.csdn.net/qq_45670134/article/details/133498728">DreamBooth 论文精读+通俗理解</a><a href="https://www.bilibili.com/video/BV1kN411w7bx/">【论文精读】Dreambooth：diffusion生成模型微调方法</a> V</p>
<h3 id="dreambooth-实战">
  Dreambooth 实战
  <a class="anchor" href="#dreambooth-%e5%ae%9e%e6%88%98">#</a>
</h3>
<ol>
<li>
<p><a href="https://huggingface.co/blog/zh/dreambooth">使用 Diffusers 通过 Dreambooth 技术来训练 Stable Diffusion</a></p>
<p><a href="https://github.com/huggingface/diffusers/tree/main/examples/dreambooth">Dreambooth Repo</a></p>
</li>
<li>
<p><a href="https://colab.research.google.com/drive/1SJB5hGwmFyiYswT8VVPCfSkL-M1TY3t1">dreambooth Diffusers examples on Colab</a> 运行过
Initial setup
Settings for teaching your new concept
Teach the model the new concept (fine-tuning with Dreambooth)
Run the code with your newly trained model</p>
</li>
</ol>
<p>1xx. <a href="https://www.notion.so/Unit-3-Stable-Diffusion-a8770ac5b0214c2f9cfce878812b5bf8?pvs=21"><strong>+ Unit 3: Stable Diffusion</strong></a></p>
<p>1xx. <a href="https://www.bilibili.com/video/BV1184y1g7pG?p=5">Dreambooth</a> V
【只训练unet】</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#approach1">Approach[1]</a></li>
    <li><a href="#dreambooth实战">Dreambooth实战</a>
      <ul>
        <li>
          <ul>
            <li><a href="#dreambooth-in-diffusers-10">Dreambooth in Diffusers [10]</a></li>
            <li><a href="#dreambooth-in-diffusers-examples11">dreambooth in Diffusers examples[11]</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#参考">参考</a>
      <ul>
        <li>
          <ul>
            <li><a href="#dreambooth-原理">Dreambooth 原理</a></li>
            <li><a href="#dreambooth-实战">Dreambooth 实战</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












